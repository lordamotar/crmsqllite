{% extends 'base.html' %}
{% load static %}

{% block title %}Dashboard - CRM —Å–∏—Å—Ç–µ–º–∞{% endblock %}

{% block content %}
<div class="container-xxl flex-grow-1 container-p-y">
  <!-- Period Filter Buttons -->
  <div class="row mb-4">
    <div class="col-12">
      <div class="d-flex justify-content-end">
        <div class="btn-group" role="group" aria-label="Period filter">
          <input type="radio" class="btn-check" name="period" id="period-1day" value="1day" {% if active_period == '1day' %}checked{% endif %}>
          <label class="btn btn-outline-primary" for="period-1day">1 –¥–µ–Ω—å</label>
          
          <input type="radio" class="btn-check" name="period" id="period-7days" value="7days" {% if active_period == '7days' %}checked{% endif %}>
          <label class="btn btn-outline-primary" for="period-7days">7 –¥–Ω–µ–π</label>
          
          <input type="radio" class="btn-check" name="period" id="period-1month" value="1month" {% if active_period == '1month' %}checked{% endif %}>
          <label class="btn btn-outline-primary" for="period-1month">1 –º–µ—Å—è—Ü</label>
          
          <input type="radio" class="btn-check" name="period" id="period-quarter" value="quarter" {% if active_period == 'quarter' %}checked{% endif %}>
          <label class="btn btn-outline-primary" for="period-quarter">–ö–≤–∞—Ä—Ç–∞–ª</label>
          
          <input type="radio" class="btn-check" name="period" id="period-halfyear" value="halfyear" {% if active_period == 'halfyear' %}checked{% endif %}>
          <label class="btn btn-outline-primary" for="period-halfyear">–ü–æ–ª–≥–æ–¥–∞</label>
          
          <input type="radio" class="btn-check" name="period" id="period-year" value="year" {% if active_period == 'year' %}checked{% endif %}>
          <label class="btn btn-outline-primary" for="period-year">–ì–æ–¥</label>
        </div>
      </div>
    </div>
  </div>
  <!--/ Period Filter Buttons -->
  
  <div class="row gy-6">
    <!-- Congratulations card -->
    <div class="col-xl-8 col-lg-7 align-self-end mt-md-7 mt-lg-4 pt-md-2 pt-lg-0">
      <div class="card">
        <div class="row">
          <div class="col-12 col-md-6">
            <div class="card-body">
              <h4 class="card-title mb-9 text-truncate">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å <span class="fw-bold">{{ user.first_name|default:user.username }}!</span>üéâ</h4>
              <p class="mb-0">–í—ã —É—Å–ø–µ—à–Ω–æ –≤–æ—à–ª–∏ –≤ CRM —Å–∏—Å—Ç–µ–º—É. –£–ø—Ä–∞–≤–ª—è–π—Ç–µ –∑–∞–∫–∞–∑–∞–º–∏, –∫–ª–∏–µ–Ω—Ç–∞–º–∏ –∏ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞–º–∏ —Å –ª–µ–≥–∫–æ—Å—Ç—å—é.</p>
            </div>
          </div>
          <div class="col-12 col-md-6 position-relative text-center">
            <img src="{% static 'frontend/assets/img/illustrations/man-with-laptop-light.png' %}" class="card-img-position bottom-0 w-auto end-0 scaleX-n1-rtl" alt="Dashboard" height="140">
          </div>
        </div>
      </div>
    </div>
    <!--/ Congratulations card -->
    
    <!-- Cards with icon profit and loss info -->
    <div class="col-xl-4 col-lg-5">
      <div class="row g-6">
        <div class="col-sm-6">
          <div class="card h-100">
            <div class="card-header d-flex align-items-center justify-content-between">
              <div class="avatar">
                <div class="avatar-initial bg-success rounded-circle shadow-xs">
                  <i class="icon-base ri ri-money-dollar-circle-line icon-24px"></i>
                </div>
              </div>
              <div class="dropdown">
                <button class="btn text-body-secondary p-0" type="button" id="revenueID" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <i class="icon-base ri ri-more-2-line icon-24px"></i>
                </button>
                <div class="dropdown-menu dropdown-menu-end" aria-labelledby="revenueID">
                  <a class="dropdown-item waves-effect" href="{% url 'orders:orders_list' %}">–ü–µ—Ä–µ–π—Ç–∏ –∫ –∑–∞–∫–∞–∑–∞–º</a>
                  <a class="dropdown-item waves-effect" href="{% url 'orders:add_order' %}">–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑</a>
                </div>
              </div>
            </div>
            <div class="card-body">
              <h6 class="mb-1">–í—ã—Ä—É—á–∫–∞</h6>
              <div class="d-flex flex-wrap mb-1 align-items-center">
                <h4 class="mb-0 me-2">‚Ç∏{{ revenue|floatformat:0 }}</h4>
                <p class="text-success mb-0">+0%</p>
              </div>
              <small>–ó–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥</small>
            </div>
          </div>
        </div>
        <div class="col-sm-6">
          <div class="card h-100">
            <div class="card-header d-flex align-items-center justify-content-between">
              <div class="avatar">
                <div class="avatar-initial bg-primary rounded-circle shadow-xs">
                  <i class="icon-base ri ri-shopping-cart-line icon-24px"></i>
                </div>
              </div>
              <div class="dropdown">
                <button class="btn text-body-secondary p-0" type="button" id="ordersID" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  <i class="icon-base ri ri-more-2-line icon-24px"></i>
                </button>
                <div class="dropdown-menu dropdown-menu-end" aria-labelledby="ordersID">
                  <a class="dropdown-item waves-effect" href="{% url 'orders:orders_list' %}">–í—Å–µ –∑–∞–∫–∞–∑—ã</a>
                  <a class="dropdown-item waves-effect" href="{% url 'orders:add_order' %}">–ù–æ–≤—ã–π –∑–∞–∫–∞–∑</a>
                </div>
              </div>
            </div>
            <div class="card-body">
              <h6 class="mb-1">–ó–∞–∫–∞–∑—ã</h6>
              <div class="d-flex flex-wrap mb-1 align-items-center">
                <h4 class="mb-0 me-2">{{ orders_count }}</h4>
                <p class="text-success mb-0">+0%</p>
              </div>
              <small>–ó–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–π –ø–µ—Ä–∏–æ–¥</small>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--/ Cards with icon profit and loss info -->

    <!-- Statistics Cards -->
    <div class="col-xl-4 col-lg-5 col-md-6 col-12 mb-4">
      <div class="card">
        <div class="card-header d-flex align-items-center justify-content-between">
          <div class="avatar">
            <div class="avatar-initial bg-info rounded-circle shadow-xs">
              <i class="icon-base ri ri-user-line icon-24px"></i>
            </div>
          </div>
          <div class="dropdown">
            <button class="btn text-body-secondary p-0" type="button" id="customersID" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <i class="icon-base ri ri-more-2-line icon-24px"></i>
            </button>
            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="customersID">
              <a class="dropdown-item waves-effect" href="{% url 'clients:clients_list' %}">–í—Å–µ –∫–ª–∏–µ–Ω—Ç—ã</a>
              <a class="dropdown-item waves-effect" href="{% url 'clients:add_client' %}">–î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</a>
            </div>
          </div>
        </div>
        <div class="card-body">
          <h6 class="mb-1">–ö–ª–∏–µ–Ω—Ç—ã</h6>
          <div class="d-flex flex-wrap mb-1 align-items-center">
            <h4 class="mb-0 me-2">{{ clients_count }}</h4>
            <p class="text-success mb-0">+0%</p>
          </div>
          <small>–ù–æ–≤—ã—Ö –∑–∞ –ø–µ—Ä–∏–æ–¥</small>
        </div>
      </div>
    </div>

    <div class="col-xl-4 col-lg-5 col-md-6 col-12 mb-4">
      <div class="card">
        <div class="card-header d-flex align-items-center justify-content-between">
          <div class="avatar">
            <div class="avatar-initial bg-warning rounded-circle shadow-xs">
              <i class="icon-base ri ri-box-3-line icon-24px"></i>
            </div>
          </div>
          <div class="dropdown">
            <button class="btn text-body-secondary p-0" type="button" id="productsID" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <i class="icon-base ri ri-more-2-line icon-24px"></i>
            </button>
            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="productsID">
              <a class="dropdown-item waves-effect" href="{% url 'products:products_list' %}">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</a>
              <a class="dropdown-item waves-effect" href="{% url 'products:add_product' %}">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</a>
            </div>
          </div>
        </div>
        <div class="card-body">
          <h6 class="mb-1">–¢–æ–≤–∞—Ä—ã</h6>
          <div class="d-flex flex-wrap mb-1 align-items-center">
            <h4 class="mb-0 me-2">{{ products_count }}</h4>
            <p class="text-success mb-0">+0%</p>
          </div>
          <small>–í –∫–∞—Ç–∞–ª–æ–≥–µ</small>
        </div>
      </div>
    </div>

    <div class="col-xl-4 col-lg-5 col-md-6 col-12 mb-4">
      <div class="card">
        <div class="card-header d-flex align-items-center justify-content-between">
          <div class="avatar">
            <div class="avatar-initial bg-secondary rounded-circle shadow-xs">
              <i class="icon-base ri ri-map-pin-line icon-24px"></i>
            </div>
          </div>
          <div class="dropdown">
            <button class="btn text-body-secondary p-0" type="button" id="citiesID" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <i class="icon-base ri ri-more-2-line icon-24px"></i>
            </button>
            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="citiesID">
              <a class="dropdown-item waves-effect" href="{% url 'cities:cities_list' %}">–í—Å–µ –≥–æ—Ä–æ–¥–∞</a>
              <a class="dropdown-item waves-effect" href="{% url 'cities:add_city' %}">–î–æ–±–∞–≤–∏—Ç—å –≥–æ—Ä–æ–¥</a>
            </div>
          </div>
        </div>
        <div class="card-body">
          <h6 class="mb-1">–ì–æ—Ä–æ–¥–∞</h6>
          <div class="d-flex flex-wrap mb-1 align-items-center">
            <h4 class="mb-0 me-2">{{ cities_count }}</h4>
            <p class="text-success mb-0">+0%</p>
          </div>
          <small>–í —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ</small>
        </div>
      </div>
    </div>
    <!--/ Statistics Cards -->

    <!-- Total Sales Chart -->
    <div class="col-xl-4 col-lg-5 col-md-6 col-12 mb-4">
      <div class="card h-100">
        <div class="card-body d-flex justify-content-between align-items-center flex-wrap">
          <div class="me-3">
            <h5 class="mb-1">–û–±—â–∏–µ –ø—Ä–æ–¥–∞–∂–∏</h5>
            <p class="mb-3">–ü–æ —Å—Ç–∞—Ç—É—Å–∞–º –∑–∞–∫–∞–∑–æ–≤</p>
            <div class="d-flex align-items-center">
              <h4 class="mb-0 me-1">‚Ç∏{{ revenue|floatformat:0 }}</h4>
              <p class="text-success mb-0"><i class="icon-base ri ri-arrow-up-s-line icon-24px"></i>+0%</p>
            </div>
          </div>
          <div id="totalSalesDonutChart" class="mt-3 mt-md-0" style="min-height: 97px;" 
               data-labels='{{ status_labels|safe }}' 
               data-values='{{ status_values|safe }}' 
               data-colors='{{ status_colors|safe }}'></div>
        </div>
      </div>
    </div>
    <!--/ Total Sales Chart -->

    <!-- Quick Actions -->
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h5>
        </div>
        <div class="card-body">
          <div class="row g-4">
            <div class="col-lg-3 col-md-6">
              <div class="d-flex align-items-center">
                <div class="avatar avatar-sm me-3">
                  <div class="avatar-initial bg-primary rounded-circle">
                    <i class="icon-base ri ri-add-line"></i>
                  </div>
                </div>
                <div class="flex-grow-1">
                  <h6 class="mb-0">–°–æ–∑–¥–∞—Ç—å –∑–∞–∫–∞–∑</h6>
                  <small class="text-body-secondary">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π –∑–∞–∫–∞–∑</small>
                </div>
                <a href="{% url 'orders:add_order' %}" class="btn btn-sm btn-outline-primary">–°–æ–∑–¥–∞—Ç—å</a>
              </div>
            </div>
            <div class="col-lg-3 col-md-6">
              <div class="d-flex align-items-center">
                <div class="avatar avatar-sm me-3">
                  <div class="avatar-initial bg-info rounded-circle">
                    <i class="icon-base ri ri-user-add-line"></i>
                  </div>
                </div>
                <div class="flex-grow-1">
                  <h6 class="mb-0">–î–æ–±–∞–≤–∏—Ç—å –∫–ª–∏–µ–Ω—Ç–∞</h6>
                  <small class="text-body-secondary">–ù–æ–≤—ã–π –∫–ª–∏–µ–Ω—Ç –≤ —Å–∏—Å—Ç–µ–º—É</small>
                </div>
                <a href="{% url 'clients:add_client' %}" class="btn btn-sm btn-outline-info">–î–æ–±–∞–≤–∏—Ç—å</a>
              </div>
            </div>
            <div class="col-lg-3 col-md-6">
              <div class="d-flex align-items-center">
                <div class="avatar avatar-sm me-3">
                  <div class="avatar-initial bg-warning rounded-circle">
                    <i class="icon-base ri ri-box-3-line"></i>
                  </div>
                </div>
                <div class="flex-grow-1">
                  <h6 class="mb-0">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h6>
                  <small class="text-body-secondary">–ù–æ–≤—ã–π —Ç–æ–≤–∞—Ä –≤ –∫–∞—Ç–∞–ª–æ–≥</small>
                </div>
                <a href="{% url 'products:add_product' %}" class="btn btn-sm btn-outline-warning">–î–æ–±–∞–≤–∏—Ç—å</a>
              </div>
            </div>
            <div class="col-lg-3 col-md-6">
              <div class="d-flex align-items-center">
                <div class="avatar avatar-sm me-3">
                  <div class="avatar-initial bg-secondary rounded-circle">
                    <i class="icon-base ri ri-map-pin-add-line"></i>
                  </div>
                </div>
                <div class="flex-grow-1">
                  <h6 class="mb-0">–î–æ–±–∞–≤–∏—Ç—å –≥–æ—Ä–æ–¥</h6>
                  <small class="text-body-secondary">–ù–æ–≤—ã–π –≥–æ—Ä–æ–¥ –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫</small>
                </div>
                <a href="{% url 'cities:add_city' %}" class="btn btn-sm btn-outline-secondary">–î–æ–±–∞–≤–∏—Ç—å</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--/ Quick Actions -->

    <!-- Recent Activity -->
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">–ü–æ—Å–ª–µ–¥–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h5>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6">
              <h6 class="mb-3">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–∫–∞–∑—ã</h6>
              {% if recent_orders %}
                {% for order in recent_orders %}
                  <div class="d-flex align-items-center mb-3">
                    <div class="avatar avatar-sm me-3">
                      <div class="avatar-initial bg-success rounded-circle">
                        <i class="icon-base ri ri-shopping-cart-line"></i>
                      </div>
                    </div>
                    <div class="flex-grow-1">
                      <h6 class="mb-0">–ó–∞–∫–∞–∑ ‚Ññ{{ order.order_number }}</h6>
                      <small class="text-body-secondary">{{ order.client }} ‚Ä¢ {{ order.created_at|date:"d.m.Y H:i" }}</small>
                    </div>
                    <span class="badge bg-label-primary">{{ order.get_status_display }}</span>
                  </div>
                {% endfor %}
              {% else %}
                <div class="d-flex align-items-center mb-4">
                  <div class="avatar avatar-sm me-3">
                    <div class="avatar-initial bg-success rounded-circle">
                      <i class="icon-base ri ri-shopping-cart-line"></i>
                    </div>
                  </div>
                  <div class="flex-grow-1">
                    <h6 class="mb-0">–ù–µ—Ç –∑–∞–∫–∞–∑–æ–≤</h6>
                    <small class="text-body-secondary">–ó–∞–∫–∞–∑—ã –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å</small>
                  </div>
                </div>
              {% endif %}
            </div>
            <div class="col-md-6">
              <h6 class="mb-3">–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç—ã</h6>
              {% if recent_clients %}
                {% for client in recent_clients %}
                  <div class="d-flex align-items-center mb-3">
                    <div class="avatar avatar-sm me-3">
                      <div class="avatar-initial bg-info rounded-circle">
                        <i class="icon-base ri ri-user-line"></i>
                      </div>
                    </div>
                    <div class="flex-grow-1">
                      <h6 class="mb-0">{{ client }}</h6>
                      <small class="text-body-secondary">{{ client.get_client_type_display }} ‚Ä¢ {{ client.created_at|date:"d.m.Y H:i" }}</small>
                    </div>
                    <span class="badge bg-label-info">{{ client.get_client_type_display }}</span>
                  </div>
                {% endfor %}
              {% else %}
                <div class="d-flex align-items-center mb-4">
                  <div class="avatar avatar-sm me-3">
                    <div class="avatar-initial bg-info rounded-circle">
                      <i class="icon-base ri ri-user-line"></i>
                    </div>
                  </div>
                  <div class="flex-grow-1">
                    <h6 class="mb-0">–ù–µ—Ç –∫–ª–∏–µ–Ω—Ç–æ–≤</h6>
                    <small class="text-body-secondary">–ö–ª–∏–µ–Ω—Ç—ã –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å</small>
                  </div>
                </div>
              {% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--/ Recent Activity -->
  </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/apexcharts@latest"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≥—Ä—É–∑–∏–ª–∞—Å—å –ª–∏ ApexCharts
    if (typeof ApexCharts === 'undefined') {
        console.error('ApexCharts –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
        return;
    }
    console.log('ApexCharts –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ');
    
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –ø–µ—Ä–∏–æ–¥–æ–≤
    const periodInputs = document.querySelectorAll('input[name="period"]');
    periodInputs.forEach(input => {
        input.addEventListener('change', function() {
            if (this.checked) {
                const url = new URL(window.location);
                url.searchParams.set('period', this.value);
                window.location.href = url.toString();
            }
        });
    });

    // –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–≥—Ä–∞–º–º—ã Total Sales
    const totalSalesChart = document.querySelector("#totalSalesDonutChart");
    if (totalSalesChart) {
        // –ß–∏—Ç–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ data-–∞—Ç—Ä–∏–±—É—Ç–æ–≤
        const statusLabels = JSON.parse(totalSalesChart.dataset.labels || '[]');
        const statusValues = JSON.parse(totalSalesChart.dataset.values || '[]');
        const statusColors = JSON.parse(totalSalesChart.dataset.colors || '[]');
        
        // –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
        console.log('Status Labels:', statusLabels);
        console.log('Status Values:', statusValues);
        console.log('Status Colors:', statusColors);
        console.log('Labels type:', typeof statusLabels);
        console.log('Values type:', typeof statusValues);
        console.log('Colors type:', typeof statusColors);
        
        // –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ–º —Å—Ç–∞—Ç—É—Å—ã –≤ —á–∏—Ç–∞–µ–º—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
        const statusNames = {
            'new': '–ù–æ–≤—ã–µ',
            'new_paid': '–ù–æ–≤—ã–µ –æ–ø–ª–∞—á–µ–Ω–Ω—ã–µ',
            'reserve': '–†–µ–∑–µ—Ä–≤',
            'transfer': '–ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ',
            'delivery': '–î–æ—Å—Ç–∞–≤–∫–∞',
            'callback': '–ü–µ—Ä–µ–∑–≤–æ–Ω–∏—Ç—å',
            'completed': '–í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ',
            'refund': '–í–æ–∑–≤—Ä–∞—Ç',
            'cancelled': '–û—Ç–º–µ–Ω–µ–Ω–Ω—ã–µ'
        };
        
        const labels = statusLabels.map(label => statusNames[label] || label);
        
        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã
        if (statusValues.length === 0 || statusValues.every(val => val === 0)) {
            console.log('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –¥–∏–∞–≥—Ä–∞–º–º—ã');
            totalSalesChart.innerHTML = '<div class="text-center text-muted">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</div>';
            return;
        }
        
        const options = {
            chart: {
                height: 100,
                width: 110,
                parentHeightOffset: 0,
                type: "donut"
            },
            labels: labels,
            series: statusValues,
            colors: statusColors,
            stroke: {
                width: 5,
                colors: ['#fff']
            },
            tooltip: {
                show: false,
                theme: 'light'
            },
            dataLabels: {
                enabled: false,
                formatter: function (val, opts) {
                    return parseInt(val) + "%"
                }
            },
            grid: {
                padding: {
                    top: -10,
                    right: -10,
                    left: -10,
                    bottom: -5
                }
            },
            legend: {
                show: false
            },
            plotOptions: {
                pie: {
                    donut: {
                        size: "75%",
                        labels: {
                            show: true,
                            value: {
                                fontSize: "1.15rem",
                                fontFamily: "Inter",
                                color: "var(--bs-heading-color)",
                                fontWeight: 500,
                                offsetY: -18,
                                formatter: function (val) {
                                    return parseInt(val) + "%"
                                }
                            },
                            name: {
                                offsetY: 18,
                                fontFamily: "Inter"
                            },
                            total: {
                                label: "",
                                label: "–í—Å–µ–≥–æ",
                                show: true,
                                fontSize: "0.75rem",
                                color: "var(--bs-body-color)",
                                fontWeight: 400,
                                formatter: function (w) {
                                    return "100%"
                                }
                            }
                        }
                    }
                }
            },
            states: {
                hover: {
                    filter: {
                        type: "none"
                    }
                },
                active: {
                    filter: {
                        type: "none"
                    }
                }
            }
        };
        
        try {
            new ApexCharts(totalSalesChart, options).render();
            console.log('–î–∏–∞–≥—Ä–∞–º–º–∞ —Å–æ–∑–¥–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ');
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –¥–∏–∞–≥—Ä–∞–º–º—ã:', error);
            totalSalesChart.innerHTML = '<div class="text-center text-danger">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∏–∞–≥—Ä–∞–º–º—ã</div>';
        }
    } else {
        console.log('–≠–ª–µ–º–µ–Ω—Ç totalSalesDonutChart –Ω–µ –Ω–∞–π–¥–µ–Ω');
    }
});
</script>
{% endblock %}
