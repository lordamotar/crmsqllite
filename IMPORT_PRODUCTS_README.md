# Инструкции по загрузке товарных позиций из Excel

## 1. Создание миграций

После изменений в моделях необходимо создать и применить миграции:

```bash
# Создание миграций
python manage.py makemigrations apps.products

# Применение миграций
python manage.py migrate
```

## 2. Установка зависимостей

Для работы с Excel файлами необходимо установить pandas и openpyxl:

```bash
pip install pandas openpyxl
```

Добавьте в `requirements.txt`:
```
pandas>=1.5.0
openpyxl>=3.0.0
```

## 3. Использование команды импорта

### Базовое использование:
```bash
python manage.py import_products other/1610.xlsx
```

### Дополнительные параметры:
```bash
# Указать конкретный лист Excel
python manage.py import_products other/1610.xlsx --sheet "Лист1"

# Очистить существующие товары перед импортом
python manage.py import_products other/1610.xlsx --clear

# Комбинированное использование
python manage.py import_products other/1610.xlsx --sheet 0 --clear
```

## 4. Структура Excel файла

Команда ожидает следующие колонки в Excel файле:

| Колонка | Обязательная | Описание |
|---------|-------------|----------|
| Код | Да | Уникальный код товара |
| Наименование | Да | Название товара |
| Отбор плана продаж | Нет | Поле для плана продаж |
| Размерность | Нет | Размер товара |
| Тип шины | Нет | Тип шины (летние/зимние/всесезонные) |
| Сезонность | Нет | Сезонность товара |
| Ассортиментная группа | Нет | Группа товаров |

## 5. Автоматическое создание групп

Команда автоматически создает следующие группы товаров:

1. АВТОШИНЫ ИМПОРТНЫЕ ЛЕГКОВЫЕ ЗИМНИЕ
2. АВТОШИНЫ ЛЕГКОВЫЕ
3. АВТОШИНЫ ЛЕГКОГРУЗОВЫЕ
4. АВТОШИНЫ ИМПОРТНЫЕ ЛЕГКОВЫЕ
5. АВТОШИНЫ ГРУЗОВЫЕ
6. ШИНОКОМПЛЕКТ (ШИНЫ + ДИСКИ)
7. АВТОШИНЫ ДЛЯ СПЕЦТЕХНИКИ-Б/Г
8. СЕЛЬХОЗШИНЫ
9. КАМЕРЫ
10. ФЛИПЕРА
11. МОТО-ВЕЛОШИНЫ
12. ДИСКИ-КОЛПАКИ

## 6. Логирование

Команда выводит подробную информацию о процессе импорта:
- Количество найденных строк
- Созданные группы товаров
- Количество созданных и обновленных товаров

## 7. Обработка ошибок

- Команда использует транзакции для обеспечения целостности данных
- При ошибке все изменения откатываются
- Проверяется наличие обязательных колонок
- Обрабатываются пустые значения

## 8. Проверка результатов

После импорта можно проверить результаты в Django Admin:
- `/admin/products/productgroup/` - группы товаров
- `/admin/products/product/` - товары

Или через shell:
```python
python manage.py shell
>>> from apps.products.models import Product, ProductGroup
>>> ProductGroup.objects.count()
>>> Product.objects.count()
```
