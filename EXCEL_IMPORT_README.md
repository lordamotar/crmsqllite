# Импорт клиентов из Excel файла

## Описание
Функциональность позволяет загружать клиентов из Excel файла (.xlsx, .xls) через веб-интерфейс на странице клиентов.

## Как использовать

### 1. Подготовка Excel файла
Создайте Excel файл со следующими колонками:

**Обязательные колонки:**
- `Телефон` - основной телефон клиента
- `Тип клиента` - "Физическое лицо" или "Юридическое лицо"
- `ФИО/Компания` - полное имя или название компании

**Дополнительные колонки:**
- `Телефон 2` - дополнительный телефон
- `Email` - email адрес
- `Фамилия` - для физических лиц
- `Имя` - для физических лиц
- `Отчество` - для физических лиц
- `Город` - город клиента

### 2. Загрузка через веб-интерфейс
1. Перейдите на страницу "Клиенты"
2. Нажмите кнопку "Загрузить из Excel"
3. Выберите Excel файл
4. Нажмите "Загрузить"
5. Просмотрите результаты импорта

### 3. Загрузка через командную строку
```bash
python manage.py import_clients_excel --file path/to/file.xlsx
```

## Особенности

### Обновление существующих клиентов
При повторной загрузке файла система автоматически:
- Находит существующих клиентов по телефону или имени
- Обновляет их данные (ФИО, email, город, дополнительные телефоны)
- Добавляет недостающую информацию (город, дополнительные телефоны)
- Сохраняет историю изменений (modified_by, modified_at)

### Проверка дубликатов
Система автоматически проверяет существующих клиентов по:
- Телефону (основному)
- Имени/названию компании

Если клиент найден, его данные обновляются. Если не найден, создается новый клиент.

### Нормализация телефонов
Телефоны автоматически нормализуются:
- `8 777 123 4567` → `+7 777 123 4567`
- `777 123 4567` → `+7 777 123 4567`
- `+7 777 123 4567` → `+7 777 123 4567`

### Типы клиентов
Поддерживаемые значения для колонки "Тип клиента":
- `Физическое лицо`, `Физ. лицо`, `Физическое`, `individual`
- `Юридическое лицо`, `Юр. лицо`, `Юридическое`, `legal_entity`

## Результаты импорта
После загрузки показывается статистика:
- Количество импортированных/обновленных клиентов
- Количество пропущенных записей с разбивкой по причинам:
  - Пустые строки
  - Неверный тип клиента
- Список ошибок (если есть)

**Примечание:** Существующие клиенты обновляются, а не пропускаются как дубликаты.

## Пример Excel файла
| Телефон | Тип клиента | ФИО/Компания | Телефон 2 | Email | Город |
|---------|-------------|--------------|-----------|-------|-------|
| +7 777 123 4567 | Физическое лицо | Иванов Иван Иванович | +7 777 111 1111 | ivanov@test.com | Алматы |
| 8 701 234 5678 | Юридическое лицо | ТОО Тест Компания | | info@company.kz | Астана |
| 777 345 6789 | Физическое лицо | Петров Петр Петрович | +7 777 222 2222 | petrov@test.com | Шымкент |
